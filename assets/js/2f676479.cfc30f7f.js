"use strict";(globalThis.webpackChunkagentops_docs=globalThis.webpackChunkagentops_docs||[]).push([[1168],{954(e,n,s){s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"integrations/anthropic","title":"Anthropic","description":"Integrate AgentOps with Anthropic Claude models","source":"@site/docs/integrations/anthropic.md","sourceDirName":"integrations","slug":"/integrations/anthropic","permalink":"/docusaurus-guide-3/docs/integrations/anthropic","draft":false,"unlisted":false,"editUrl":"https://github.com/agentops/agentops-docs/tree/main/docs/integrations/anthropic.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"Anthropic","description":"Integrate AgentOps with Anthropic Claude models"},"sidebar":"docsSidebar","previous":{"title":"OpenAI","permalink":"/docusaurus-guide-3/docs/integrations/openai"},"next":{"title":"LangChain","permalink":"/docusaurus-guide-3/docs/integrations/langchain"}}');var r=s(4848),a=s(8453);const o={sidebar_position:3,title:"Anthropic",description:"Integrate AgentOps with Anthropic Claude models"},i="Anthropic Integration",l={},c=[{value:"Quick Start",id:"quick-start",level:2},{value:"Supported Models",id:"supported-models",level:2},{value:"Features",id:"features",level:2},{value:"Basic Messages",id:"basic-messages",level:3},{value:"System Prompts",id:"system-prompts",level:3},{value:"Multi-turn Conversations",id:"multi-turn-conversations",level:3},{value:"Streaming",id:"streaming",level:3},{value:"Tool Use",id:"tool-use",level:3},{value:"Vision",id:"vision",level:3},{value:"Async Support",id:"async-support",level:3},{value:"Tracked Data",id:"tracked-data",level:2},{value:"Pricing",id:"pricing",level:2},{value:"Advanced Usage",id:"advanced-usage",level:2},{value:"Conversation Management",id:"conversation-management",level:3},{value:"Tool Use Handling",id:"tool-use-handling",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"1. Choose the Right Model",id:"1-choose-the-right-model",level:3},{value:"2. Use System Prompts Effectively",id:"2-use-system-prompts-effectively",level:3},{value:"3. Tag Sessions Appropriately",id:"3-tag-sessions-appropriately",level:3},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"anthropic-integration",children:"Anthropic Integration"})}),"\n",(0,r.jsx)(n.p,{children:"AgentOps provides full integration with Anthropic's Claude models, automatically tracking all API calls and conversations."}),"\n",(0,r.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'import agentops\nfrom anthropic import Anthropic\n\n# Initialize AgentOps\nagentops.init(api_key="your-agentops-api-key")\n\n# Create Anthropic client\nclient = Anthropic()\n\n# Make API calls - automatically tracked\nmessage = client.messages.create(\n    model="claude-3-opus-20240229",\n    max_tokens=1024,\n    messages=[\n        {"role": "user", "content": "What is the theory of relativity?"}\n    ]\n)\n\nprint(message.content[0].text)\nagentops.end_session(end_state="Success")\n'})}),"\n",(0,r.jsx)(n.h2,{id:"supported-models",children:"Supported Models"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Model"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"claude-3-opus-20240229"})}),(0,r.jsx)(n.td,{children:"Most capable model"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"claude-3-sonnet-20240229"})}),(0,r.jsx)(n.td,{children:"Balanced performance"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"claude-3-haiku-20240307"})}),(0,r.jsx)(n.td,{children:"Fast and efficient"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"claude-2.1"})}),(0,r.jsx)(n.td,{children:"Previous generation"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"claude-2.0"})}),(0,r.jsx)(n.td,{children:"Previous generation"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,r.jsx)(n.h3,{id:"basic-messages",children:"Basic Messages"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'message = client.messages.create(\n    model="claude-3-sonnet-20240229",\n    max_tokens=1024,\n    messages=[\n        {"role": "user", "content": "Explain quantum computing"}\n    ]\n)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"system-prompts",children:"System Prompts"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'message = client.messages.create(\n    model="claude-3-opus-20240229",\n    max_tokens=1024,\n    system="You are a helpful Python programming assistant.",\n    messages=[\n        {"role": "user", "content": "How do I read a CSV file?"}\n    ]\n)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"multi-turn-conversations",children:"Multi-turn Conversations"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'messages = [\n    {"role": "user", "content": "I want to learn about machine learning"},\n    {"role": "assistant", "content": "Great! Let\'s start with the basics..."},\n    {"role": "user", "content": "What are neural networks?"}\n]\n\nresponse = client.messages.create(\n    model="claude-3-sonnet-20240229",\n    max_tokens=1024,\n    messages=messages\n)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"streaming",children:"Streaming"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'with client.messages.stream(\n    model="claude-3-sonnet-20240229",\n    max_tokens=1024,\n    messages=[{"role": "user", "content": "Write a poem about AI"}]\n) as stream:\n    for text in stream.text_stream:\n        print(text, end="")\n\n# Complete response tracked after stream ends\n'})}),"\n",(0,r.jsx)(n.h3,{id:"tool-use",children:"Tool Use"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'tools = [\n    {\n        "name": "get_weather",\n        "description": "Get the current weather for a location",\n        "input_schema": {\n            "type": "object",\n            "properties": {\n                "location": {\n                    "type": "string",\n                    "description": "City name"\n                }\n            },\n            "required": ["location"]\n        }\n    }\n]\n\nresponse = client.messages.create(\n    model="claude-3-opus-20240229",\n    max_tokens=1024,\n    tools=tools,\n    messages=[{"role": "user", "content": "What\'s the weather in Paris?"}]\n)\n\n# Tool usage is tracked\nfor block in response.content:\n    if block.type == "tool_use":\n        print(f"Tool: {block.name}")\n        print(f"Input: {block.input}")\n'})}),"\n",(0,r.jsx)(n.h3,{id:"vision",children:"Vision"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'import base64\n\n# Read and encode image\nwith open("image.jpg", "rb") as f:\n    image_data = base64.standard_b64encode(f.read()).decode("utf-8")\n\nmessage = client.messages.create(\n    model="claude-3-opus-20240229",\n    max_tokens=1024,\n    messages=[\n        {\n            "role": "user",\n            "content": [\n                {\n                    "type": "image",\n                    "source": {\n                        "type": "base64",\n                        "media_type": "image/jpeg",\n                        "data": image_data\n                    }\n                },\n                {\n                    "type": "text",\n                    "text": "What\'s in this image?"\n                }\n            ]\n        }\n    ]\n)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"async-support",children:"Async Support"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'import asyncio\nfrom anthropic import AsyncAnthropic\n\nagentops.init(api_key="your-agentops-api-key")\n\nasync def main():\n    client = AsyncAnthropic()\n\n    message = await client.messages.create(\n        model="claude-3-sonnet-20240229",\n        max_tokens=1024,\n        messages=[{"role": "user", "content": "Hello!"}]\n    )\n\n    print(message.content[0].text)\n\nasyncio.run(main())\n'})}),"\n",(0,r.jsx)(n.h2,{id:"tracked-data",children:"Tracked Data"}),"\n",(0,r.jsx)(n.p,{children:"For each Anthropic call, AgentOps captures:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Field"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"model"})}),(0,r.jsx)(n.td,{children:"Model used"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"system"})}),(0,r.jsx)(n.td,{children:"System prompt"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"messages"})}),(0,r.jsx)(n.td,{children:"Conversation messages"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"response"})}),(0,r.jsx)(n.td,{children:"Response content"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"input_tokens"})}),(0,r.jsx)(n.td,{children:"Input token count"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"output_tokens"})}),(0,r.jsx)(n.td,{children:"Output token count"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"cost"})}),(0,r.jsx)(n.td,{children:"Calculated cost"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"latency_ms"})}),(0,r.jsx)(n.td,{children:"Response time"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"stop_reason"})}),(0,r.jsx)(n.td,{children:"Why generation stopped"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"tool_use"})}),(0,r.jsx)(n.td,{children:"Any tool calls made"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"pricing",children:"Pricing"}),"\n",(0,r.jsx)(n.p,{children:"AgentOps calculates costs based on Anthropic pricing:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Model"}),(0,r.jsx)(n.th,{children:"Input (per 1K)"}),(0,r.jsx)(n.th,{children:"Output (per 1K)"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"claude-3-opus"}),(0,r.jsx)(n.td,{children:"$0.015"}),(0,r.jsx)(n.td,{children:"$0.075"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"claude-3-sonnet"}),(0,r.jsx)(n.td,{children:"$0.003"}),(0,r.jsx)(n.td,{children:"$0.015"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"claude-3-haiku"}),(0,r.jsx)(n.td,{children:"$0.00025"}),(0,r.jsx)(n.td,{children:"$0.00125"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"advanced-usage",children:"Advanced Usage"}),"\n",(0,r.jsx)(n.h3,{id:"conversation-management",children:"Conversation Management"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'class ConversationManager:\n    def __init__(self, model="claude-3-sonnet-20240229"):\n        self.client = Anthropic()\n        self.model = model\n        self.messages = []\n        self.system = None\n\n    def set_system(self, system_prompt):\n        self.system = system_prompt\n\n    def chat(self, user_message):\n        self.messages.append({"role": "user", "content": user_message})\n\n        response = self.client.messages.create(\n            model=self.model,\n            max_tokens=1024,\n            system=self.system,\n            messages=self.messages\n        )\n\n        assistant_message = response.content[0].text\n        self.messages.append({"role": "assistant", "content": assistant_message})\n\n        return assistant_message\n\n# Usage\nagentops.init(api_key="your-agentops-api-key")\nsession = agentops.start_session(tags=["anthropic", "conversation"])\n\nconv = ConversationManager()\nconv.set_system("You are a friendly assistant.")\nconv.chat("Hello!")\nconv.chat("What can you help me with?")\n\nsession.end(end_state="Success")\n'})}),"\n",(0,r.jsx)(n.h3,{id:"tool-use-handling",children:"Tool Use Handling"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'def handle_tool_use(response):\n    """Process tool use requests from Claude."""\n    results = []\n\n    for block in response.content:\n        if block.type == "tool_use":\n            # Track tool call\n            agentops.record(Event(\n                event_type="claude_tool_request",\n                params={\n                    "tool": block.name,\n                    "input": block.input\n                }\n            ))\n\n            # Execute tool\n            result = execute_tool(block.name, block.input)\n\n            results.append({\n                "type": "tool_result",\n                "tool_use_id": block.id,\n                "content": result\n            })\n\n    return results\n'})}),"\n",(0,r.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'import agentops\nfrom anthropic import Anthropic, APIError, RateLimitError\n\nagentops.init(api_key="your-agentops-api-key")\nclient = Anthropic()\n\ntry:\n    message = client.messages.create(\n        model="claude-3-opus-20240229",\n        max_tokens=1024,\n        messages=[{"role": "user", "content": "Hello!"}]\n    )\n    agentops.end_session(end_state="Success")\n\nexcept RateLimitError as e:\n    agentops.record(ErrorEvent(\n        error_type="RateLimitError",\n        details=str(e)\n    ))\n    agentops.end_session(end_state="Fail", end_state_reason="Rate limited")\n\nexcept APIError as e:\n    agentops.record(ErrorEvent(\n        error_type="APIError",\n        details=str(e)\n    ))\n    agentops.end_session(end_state="Fail", end_state_reason=str(e))\n'})}),"\n",(0,r.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsx)(n.h3,{id:"1-choose-the-right-model",children:"1. Choose the Right Model"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# Complex reasoning - use Opus\ncomplex_response = client.messages.create(\n    model="claude-3-opus-20240229",\n    max_tokens=2048,\n    messages=[{"role": "user", "content": complex_task}]\n)\n\n# General tasks - use Sonnet\ngeneral_response = client.messages.create(\n    model="claude-3-sonnet-20240229",\n    max_tokens=1024,\n    messages=[{"role": "user", "content": general_task}]\n)\n\n# Simple/fast tasks - use Haiku\nsimple_response = client.messages.create(\n    model="claude-3-haiku-20240307",\n    max_tokens=256,\n    messages=[{"role": "user", "content": simple_task}]\n)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"2-use-system-prompts-effectively",children:"2. Use System Prompts Effectively"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'message = client.messages.create(\n    model="claude-3-sonnet-20240229",\n    max_tokens=1024,\n    system="""You are a technical documentation writer.\n    - Use clear, concise language\n    - Include code examples\n    - Format with markdown""",\n    messages=[{"role": "user", "content": "Document the login API"}]\n)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"3-tag-sessions-appropriately",children:"3. Tag Sessions Appropriately"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'session = agentops.start_session(tags=[\n    "anthropic",\n    "claude-3-opus",\n    "analysis",\n    "production"\n])\n'})}),"\n",(0,r.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/advanced/custom-events",children:"Tool Use Guide"})," - Advanced tool patterns"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/features/cost-tracking",children:"Cost Tracking"})," - Monitor Claude costs"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/guides/best-practices",children:"Best Practices"})," - Optimization tips"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453(e,n,s){s.d(n,{R:()=>o,x:()=>i});var t=s(6540);const r={},a=t.createContext(r);function o(e){const n=t.useContext(a);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);